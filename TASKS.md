# TASKS.md — Задачи для агентов
# Читать когда нужно выполнить задачу. CLAUDE.md — для контекста проекта.

## TASK-001: Write-Ahead Buffer ✅ ВЫПОЛНЕНО 19.02.2026

## TASK-002: Исправить checko_client.py ✅ ВЫПОЛНЕНО 19.02.2026

## TASK-003: Исправить enricher.py ✅ ВЫПОЛНЕНО 19.02.2026

## TASK-004: Реализовать скоринг оркестратору  ✅ ВЫПОЛНЕНО 19.02.2026

## TASK-005: Telegram уведомления — проверить и протестировать ✅ ВЫПОЛНЕНО 19.02.2026

## TASK-007: Починить ветки в git ✅ ВЫПОЛНЕНО 19.02.2026

## TASK-006: Навести порядок в репозитории ✅ ВЫПОЛНЕНО 19.02.2026

## TASK-007: Починить ветки в git ✅ ВЫПОЛНЕНО 19.02.2026

## TASK-008: Улучшение скоринга (deal_score)✅ ВЫПОЛНЕНО 21.02.2026

## TASK-009: Оптимизация API-запросов ✅ ВЫПОЛНЕНО 21.02.2026

## TASK-010: Интеграция /v1/trade-messages (ЭТП) ✅ ВЫПОЛНЕНО 22.02.2026

## TASK-011: Семантический поиск + таблица leads ✅ ВЫПОЛНЕНО 21.02.2026

## TASK-012: Поиск по тексту торговых объявлений ❌ ОТМЕНЕНО 23.02.2026

**Причина отмены:** эндпоинт `trade_messages?search=...` не существует в реальном API
(parser-api.com поддерживает только `search_ur`, `get_org_messages`, `get_message`).
Все 3 запуска за 23.02 вернули 0 результатов.

## TASK-013: Восстановить рабочий пайплайн + исправить гео-фильтр ✅ ВЫПОЛНЕНО 23.02.2026

**Проблема:** два бага в поиске:
1. TASK-012 использовал несуществующий API эндпоинт → 0 лотов
2. Гео-фильтр в `_filter_lot` проверял адрес регистрации должника вместо адреса лота
   → лоты из любого региона проходили, если юрлицо прописано в Москве (Камчатка и т.д.)

**Исправлено:**
- `search_lots()` — возврат к пайплайну: `search_ur(77)` → `get_org_messages` → `get_message` → фильтр
- `_filter_lot()` — гео-фильтр теперь проверяет только `lot.description` + `lot.address/location`,
  адрес должника исключён из проверки
